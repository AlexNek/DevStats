<UserControl x:Class="DevStats.Plugins.CsStatistics.CsStatisticsCardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:DevStats.Converters"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:scottPlot="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF">

  <UserControl.Resources>
    <converters:FileSizeConverter x:Key="FileSizeConverter"/>
    <converters:IntGreaterThanZeroToVisibilityConverter x:Key="IntGreaterThanZeroToVisibilityConverter"/>
  </UserControl.Resources>

  <StackPanel>
    <!-- Summary stats  -->
    <Grid Margin="0,0,0,8">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>

      <!-- Row 1 -->
      <TextBlock Text="Analyzed Files:" FontWeight="Bold" Grid.Row="0" Grid.Column="0"/>
      <TextBlock Text="{Binding FilesCount}" Margin="4,0,16,0" Grid.Row="0" Grid.Column="1"/>

      <!-- Row 2 -->
      <TextBlock Text="Auto-Generated:" FontWeight="Bold" Grid.Row="1" Grid.Column="0"/>
      <TextBlock Text="{Binding AutoGeneratedCount}" Margin="4,0,16,0" Grid.Row="1" Grid.Column="1"/>

      <!-- Row 3 -->
      <TextBlock Text="Total Files:" FontWeight="Bold" Grid.Row="2" Grid.Column="0"/>
      <TextBlock Text="{Binding TotalFilesCount}" Margin="4,0,0,0" Grid.Row="2" Grid.Column="1"/>

      <!-- Row 4 -->
      <TextBlock Text="Zero-Size Files:" FontWeight="Bold" Grid.Row="3" Grid.Column="0"/>
      <TextBlock Text="{Binding ZeroSizeFilesCount}" Margin="4,0,0,0" Grid.Row="3" Grid.Column="1"/>
    </Grid>

    <StackPanel Orientation="Horizontal"
                Visibility="{Binding AccessErrorCount, Converter={StaticResource IntGreaterThanZeroToVisibilityConverter}}">
      <TextBlock Text="Access Errors: " FontWeight="Bold"/>
      <TextBlock Text="{Binding AccessErrorCount}" Margin="4,0,16,0"/>
    </StackPanel>
    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
      <TextBlock Text="Min: " FontWeight="Bold"/>
      <TextBlock Text="{Binding MinSize, Converter={StaticResource FileSizeConverter}}" Margin="4,0,16,0"/>
      <TextBlock Text="Max: " FontWeight="Bold"/>
      <TextBlock Text="{Binding MaxSize, Converter={StaticResource FileSizeConverter}}" Margin="4,0,16,0"/>
      <TextBlock Text="Avg: " FontWeight="Bold"/>
      <TextBlock Text="{Binding AverageSize, Converter={StaticResource FileSizeConverter}}" Margin="4,0,0,0"/>
    </StackPanel>

    <!-- Modern Wpf.Ui TabControl -->
    <TabControl Height="450" Margin="0,8,0,0">
      <!-- Table Tab -->
      <TabItem>
        <TabItem.Header>
          <StackPanel Orientation="Horizontal">
            <!-- Use a TextBlock for a Unicode icon, or an Image for a bitmap/svg -->
            <TextBlock Text="📋" FontSize="14" Margin="0,0,4,0"/>
            <TextBlock Text="Table View"/>
          </StackPanel>
        </TabItem.Header>
        <DataGrid ItemsSource="{Binding HistogramItems}" AutoGenerateColumns="False" IsReadOnly="True"
                  MouseDoubleClick="HistogramGrid_MouseDoubleClick">
          <DataGrid.Columns>
            <DataGridTextColumn Header="Size Range" Binding="{Binding Range}" Width="2*"/>
            <DataGridTextColumn Header="Files Count" Binding="{Binding Count}" Width="*"/>
          </DataGrid.Columns>
        </DataGrid>
      </TabItem>

      <!-- Chart Tab -->
      <TabItem>
        <TabItem.Header>
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="📊" FontSize="14" Margin="0,0,4,0"/>
            <TextBlock Text="Chart View"/>
          </StackPanel>
        </TabItem.Header>
        <scottPlot:WpfPlot x:Name="HistogramPlot" Loaded="HistogramPlot_Loaded"/>
      </TabItem>
    </TabControl>
  </StackPanel>
</UserControl>